> GB2312 -> GBK -> GB18030 是中文编码的三套方案，出现的时间从早到晚，收录的字符数目依次增加，并且向下兼容。GB2312 和 GBK 收录的字符数目较少，用 1~2个字节存储；GB18030 收录的字符最多，用1、2、4 个字节存储。

<br/>

# 一、本地化编码的由来
计算机是一种改变世界的发明，很快就从美国传到了全球各地，得到了所有国家的认可，成为了一种不可替代的工具。计算机在广泛流行的过程中遇到的一个棘手问题就是字符编码，计算机是美国人发明的，它使用的是 ASCII 编码，只能显示英文字符，对汉语、韩语、日语、法语、德语等其它国家的字符无能为力。  
为了让本国公民也能使用上计算机，<mark class="hltr-blue">各个国家（地区）也开始效仿 ASCII，开发了自己的字符编码。这些字符编码和 ASCII 一样，只考虑本国的语言文化，不兼容其它国家的文字。</mark>这样做的后果就是，一台计算机上必须安装多套字符编码，否则就不能正确地跨国传递数据，例如在中国编写的文本文件，拿到日本的电脑上就无法打开，或者打开后是一堆乱码。
<br/>

# 二、常见的字符编码

> 由于 ASCII 先入为主，已经使用了十来年了，现有的很多软件和文档都是基于 ASCII 的，所以后来的这些字符编码都是在 ASCII 基础上进行的扩展，它们都兼容 ASCII，以支持既有的软件和文档。
> 兼容 ASCII 的含义是，原来 ASCII 中已经包含的字符，<mark class="hltr-red">在国家编码（地区编码）中的位置不变（也就是编码值不变），只是在这些字符的后面增添了新的字符</mark>。

|字符编码|说明|
|---|---|
|ISO/IEC&nbsp;8859|**欧洲字符集**，支持丹麦语、荷兰语、德语、意大利语、拉丁语、挪威语、葡萄牙语、西班牙语，瑞典语等，1987 年首次发布。<br>ASCII 编码只包含了基本的拉丁字母，没有包含欧洲很多国家所用到的一些扩展的拉丁字母，比如一些重音字母，带音标的字母等，ISO/IEC 8859 主要是在 ASCII 的基础上增加了这些衍生的拉丁字母。|
|Shift_Jis|**日语字符集**，包含了全角及半角拉丁字母、平假名、片假名、符号及日语汉字，1978 年首次发布。|
|Big5|**繁体中文字符集**，1984 年发布，通行于台湾、香港等地区，收录了 13053 个中文字、408个普通字符以及 33 个控制字符。|
|GB2312|**简体中文字符集**，1980 年发布，共收录了 6763 个汉字，其中一级汉字 3755 个，二级汉字 3008 个；同时收录了包括拉丁字母、希腊字母、日文平假名及片假名字母、俄语西里尔字母在内的 682 个字符。|
|GBK|**中文字符集**，是在 GB2312 的基础上进行的扩展，1995 年发布。 <br>GB2312 收录的汉字虽然覆盖了中国大陆 99.75% 的使用频率，满足了基本的输入输出要求，但是对于人名、古汉语等方面出现的罕用字（例如朱镕基的“镕”就没有被 GB2312 收录），GB2312 并不能处理，所以后来又对 GBK 进行了一次扩展，形成了一种新的字符集，就是 GBK。<br>GBK 共收录了 21886 个汉字和图形符号，包括 GB2312 中的全部汉字、非汉字符号，以及 BIG5 中的全部繁体字，还有一些生僻字。|
|GB18030|**中文字符集**，是对 GBK 和 GB2312 的又一次扩展，2000 年发布。 <br>GB18030 共收录 70244 个汉字，支持中国国内少数民族的文字，以及日语韩语中的汉字。|
<br/>

# 三、中文编码方案
标准 ASCII 编码共包含了 128 个字符，用一个字节就足以存储（实际上是用一个字节中较低的 7 位来存储），而日文、中文、韩文等包含的字符非常多，有成千上万个，一个字节肯定是不够的（一个字节最多存储 28 = 256 个字符），所以要进行扩展，用两个、三个甚至四个字节来表示。  
  
在制定字符编码时还要考虑内存利用率的问题。我们经常使用的字符，其编码值一般都比较小，例如字母和数字都是 ASCII 编码，其编码值不会超过 127，用一个字节存储足以，如果硬要用多个字节存储，就会浪费很多内存空间。  
  
为了达到「<mark class="hltr-blue">既能存储本国字符，又能节省内存</mark>」的目的，Shift-Jis、Big5、GB2312 等都采用变长的编码方式：
- 对于原来的 ASCII 编码部分，用一个字节存储足以；
- 对于本国的常用字符（例如汉字、标点符号等），一般用两个字节存储；
- 对于偏远地区，或者极少使用的字符（例如藏文、蒙古文等），才使用三个甚至四个字节存储。

总起来说，越常用的字符占用的内存越少，越罕见的字符占用的内存越多。

<br/>

## 3.1 GB2312与GBK标准的编码方案

从整体上讲，GB2312 和 GBK 的编码方式一致，具体为：
- 对于 ASCII 字符，使用一个字节存储，并且该字节的最高位是 0，这和 ASCII 编码是一致的，所以说 GB2312 完全兼容 ASCII。
- 对于中国的字符，使用两个字节存储，并且规定每个字节的最高位都是 1。
### 示例
| 编码字符 | 实际存储内容      | 存储字节长度 |
| -------- | ----------------- | ------------ |
| A        | 01000001          | 1Bytes       |
| 中       | 11010110 11010000 | 2Bytes       |

<br/>

## 3.2 GB18030编码方案

GB18030 为了容纳更多的字符，并且要区分两个字节和四个字节，所以修改了编码方案，具体为：  
- 对于 ASCII 字符，使用一个字节存储，并且该字节的最高位是 0，这和 ASCII、GB2312、GBK 编码是一致的。
- 对于常用的中文字符，使用两个字节存储，并且规定第一个字节的最高位是 1，第二个字节的高位最多只能有一个连续的 0（第二个字节的最高位可以是 1 也可以是 0，但是当它是 0 时，次高位就不能是 0 了）。注意对比 GB2312 和 GBK，它们要求两个字节的最高位为都必须为 1。
- 对于罕见的字符，使用四个字节存储，并且规定第一个和第三个字节的最高位是 1，第二个和第四个字节的高位必须有两个连续的 0。

### 示例
| 编码字符 | 实际存储内容                        | 存储字节长度 |
| -------- | ----------------------------------- | ------------ |
| A        | 01000001                            | 1Bytes       |
| 中       | 11010110 11010000                   | 2Bytes       |
| གྱུ(藏文)    | 10000001 00110010 11101111 00110000 | 4Bytes       |

字符处理软件在处理文本时，从左往右依次扫描每个字节：
- 如果遇到的字节的最高位是 0，那么就会断定该字符只占用了一个字节；
- 如果遇到的字节的最高位是 1，那么该字符可能占用了两个字节，也可能占用了四个字节，不能妄下断论，所以还要继续往后扫描：
    - 如果第二个字节的高位有两个连续的 0，那么就会断定该字符占用了四个字节；
    - 如果第二个字节的高位没有连续的 0，那么就会断定该字符占用了两个字节。
<mark class="hltr-blue">可见，当字符占用两个或者四个字节时，GB18030 编码要检测两次，处理效率比 GB2312 和 GBK 都低。</mark>

<br/>


# 四、GBK编码是最常见的中文编码

GBK 于 1995 年发布，这一年也是互联网爆发的元年，国人使用电脑越来越多，后来的中文版 Windows 都将 GBK 作为默认的中文编码方案。  

注意，这里我说 GBK 是默认的中文编码方案，并没有说 Windows 默认支持 GBK。Windows 在内核层面使用的是 Unicode 字符集（严格来说是 UTF-16 编码），但是它也给用户留出了选择的余地，如果用户不希望使用 Unicode，而是希望使用中文编码方案，那么这个时候 Windows 默认使用 GBK（当然，你可以选择使用 GB2312 或者 GB18030，不过一般没有这个必要）。

实际上，中文版 Windows 下的很多程序默认使用的就是 GBK 编码，例如用记事本程序创建一个 txt 文档、在 cmd 或者控制台程序（最常见的C语言程序）中显示汉字、用 Visual Studio 创建的源文件等，使用的都是 GBK 编码。